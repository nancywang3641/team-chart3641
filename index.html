<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>å…¬å¸çµ„ç¹”ç¸½è¡¨ (ç‹æœ¨æ¦®/è‘‰è‰·ç§‹)</title>
    <style>
        /* --- åŸºç¤è¨­å®š --- */
        body {
            font-family: "Microsoft JhengHei", "Segoe UI", sans-serif;
            background-color: #f4f6f8;
            padding: 20px;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* --- é ‚éƒ¨æ§åˆ¶å€ --- */
        .header-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .btn-group button {
            padding: 8px 15px;
            cursor: pointer;
            border: 1px solid #ddd;
            background: #fff;
            border-radius: 4px;
            font-size: 14px;
            margin-right: 5px;
        }
        .btn-group button:hover { background: #f0f0f0; }
        .btn-print { background-color: #007bff !important; color: white; border: none !important; }
        .btn-print:hover { background-color: #0056b3 !important; }

        /* --- Tab åˆ†é ç±¤è¨­è¨ˆ --- */
        .tab-nav {
            display: flex;
            border-bottom: 2px solid #ddd;
            margin-bottom: 20px;
        }

        .tab-btn {
            padding: 12px 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            color: #666;
            background: #e9ecef;
            border: none;
            border-radius: 8px 8px 0 0;
            margin-right: 5px;
            transition: all 0.2s;
        }

        .tab-btn:hover { background: #dde2e6; }

        .tab-btn.active {
            background: #fff;
            color: #007bff;
            border: 2px solid #ddd;
            border-bottom: 2px solid #fff; /* è“‹éåº•ç·š */
            margin-bottom: -2px;
        }

        /* --- Tab å…§å®¹å€ --- */
        .tab-content { display: none; } /* é è¨­éš±è— */
        .tab-content.active { display: block; animation: fadeIn 0.3s; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* --- æ¨¹ç‹€çµæ§‹ --- */
        ul { list-style: none; padding-left: 20px; margin: 0; }
        .tree ul { border-left: 1px solid #ccc; margin-left: 5px; }
        .tree > ul { border-left: none; padding-left: 0; margin-left: 0; }
        
        li { margin: 5px 0; position: relative; }
        li::before {
            content: ''; position: absolute; top: 18px; left: -20px;
            width: 15px; height: 1px; background: #ccc;
        }
        .tree > ul > li::before { display: none; }

        /* --- ç¯€é»å¡ç‰‡ --- */
        .node-content {
            display: inline-flex;
            align-items: center;
            background: white;
            padding: 8px 12px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            cursor: pointer;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            transition: all 0.2s;
        }
        .node-content:hover { border-color: #2196f3; background: #f0f8ff; }

        /* æŠ˜ç–ŠæŒ‰éˆ• */
        .toggle-btn {
            width: 20px; height: 20px; margin-right: 10px;
            border-radius: 50%; background: #eee; color: #555;
            display: flex; justify-content: center; align-items: center;
            font-weight: bold; font-size: 14px;
        }
        .toggle-btn.empty { visibility: hidden; }

        /* è³‡æ–™æ–‡å­— */
        .rank-tag { padding: 2px 8px; font-size: 12px; border-radius: 4px; margin-right: 10px; font-weight: bold; border: 1px solid rgba(0,0,0,0.1); }
        .name { font-weight: bold; font-size: 15px; margin-right: 8px; }
        .id { color: #888; font-size: 13px; font-family: monospace; margin-right: 10px; }
        .date { color: #aaa; font-size: 12px; }
        .count { font-size: 11px; color: #fff; background: #999; padding: 1px 6px; border-radius: 10px; margin-left: 8px; }

        /* é¡è‰²å®šç¾© */
        .dia { background: #b3e5fc; border-color: #00b4d8; color: #0077b6; }
        .pla { background: #e0f7fa; border-color: #90e0ef; color: #0096c7; }
        .gold { background: #fff9c4; border-color: #ffd166; color: #b45309; }
        .sil { background: #f5f5f5; border-color: #c0c0c0; color: #666; }
        .vip { background: #fce4ec; border-color: #ff006e; color: #a4133c; }
        .emp { background: #eee; border: 1px dashed #ccc; color: #999; }

        .hidden { display: none; }

        /* --- åˆ—å°è¨­å®š (é—œéµ) --- */
        @media print {
            .header-controls, .tab-nav { display: none; } /* éš±è—æŒ‰éˆ•å’Œé ç±¤ */
            body { background: white; margin: 0; padding: 0; max-width: 100%; }
            .tab-content { display: none !important; } /* å…ˆéš±è—æ‰€æœ‰å…§å®¹ */
            .tab-content.active { display: block !important; } /* åªé¡¯ç¤ºç•¶å‰é ç±¤ */
            .node-content { border: none; border-bottom: 1px solid #eee; padding: 5px 0; box-shadow: none; }
            .hidden { display: none !important; } /* éš±è—æŠ˜ç–Šçš„ç¯€é» */
            * { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        }
    </style>
</head>
<body>

<div class="header-controls">
    <div style="font-weight: bold; font-size: 18px;">çµ„ç¹”çµæ§‹ç¸½è¦½</div>
    <div class="btn-group">
        <button class="btn-print" onclick="window.print()">ğŸ–¨ï¸ åˆ—å°ç›®å‰åˆ†é </button>
        <button onclick="expandAll()">å…¨éƒ¨å±•é–‹</button>
        <button onclick="collapseAll()">å…¨éƒ¨æŠ˜ç–Š</button>
    </div>
</div>

<div class="tab-nav">
    <button class="tab-btn active" onclick="switchTab('wang', this)">ğŸ‘‘ ç‹æœ¨æ¦® åœ˜éšŠ</button>
    <button class="tab-btn" onclick="switchTab('yeh', this)">ğŸŒ¿ è‘‰è‰·ç§‹ åœ˜éšŠ</button>
</div>

<div id="wang" class="tab-content active">
    <div id="tree-wang" class="tree"></div>
</div>

<div id="yeh" class="tab-content">
    <div id="tree-yeh" class="tree"></div>
</div>

<script>
    // --- 1. è³‡æ–™å€ (Data) ---

    // ç‹æœ¨æ¦®çš„è³‡æ–™ (ä½¿ç”¨èˆŠæ ¼å¼ ã€ã€‘)
    const rawDataWang = `
ã€ç‹æœ¨æ¦®ã€‘ (OV25120039) - é‘½çŸ³ - åŠ å…¥: 2025-12-14
â”œâ”€â”€ ã€ç‹æœ¨æ¦®ã€‘ (OV25120040) - ç™½é‡‘ - åŠ å…¥: 2025-12-13
â”‚   â”œâ”€â”€ ã€ç‹æœ¨æ¦®ã€‘ (OV25120041) - ç™½é‡‘ - åŠ å…¥: 2025-12-13
â”‚   â”‚   â””â”€â”€ ã€æ›¹æ™‚èªã€‘ (OV25120048) - ç™½é‡‘ - åŠ å…¥: 2025-12-13
â”‚   â”‚       â”œâ”€â”€ ã€æ›¹æ™‚èªã€‘ (OV25120049) - ç™½é‡‘ - åŠ å…¥: 2025-12-13
â”‚   â”‚       â”‚   â””â”€â”€ ã€SimplyShalã€‘ (OV25120058) - é‘½çŸ³ - åŠ å…¥: 2025-12-13
â”‚   â”‚       â”‚       â”œâ”€â”€ ã€SimplyShalã€‘ (OV25120094) - ç™½é‡‘ - åŠ å…¥: 2025-12-13
â”‚   â”‚       â”‚       â”‚   â”œâ”€â”€ ã€SimplyShalã€‘ (OV25120095) - ç™½é‡‘ - åŠ å…¥: 2025-12-13
â”‚   â”‚       â”‚       â”‚   â”‚   â”œâ”€â”€ ã€ChanSokeHoã€‘ (OV25120214) - é‘½çŸ³ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ ã€Aweyahaã€‘ (OV25120307) - é‘½çŸ³ - åŠ å…¥: 2025-12-26
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ã€SeowLizhuCã€‘ (OV25120315) - é‡‘ç´š - åŠ å…¥: 2025-12-26
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ã€WuXiujinã€‘ (OV25120316) - ç™½é‡‘ - åŠ å…¥: 2025-12-26
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ã€WuXiujinã€‘ (OV25120317) - ç™½é‡‘ - åŠ å…¥: 2025-12-26
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ã€YewHongKooã€‘ (OV25120319) - ç™½é‡‘ - åŠ å…¥: 2025-12-26
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ã€WuXiujinã€‘ (OV25120318) - ç™½é‡‘ - åŠ å…¥: 2025-12-26
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ã€ZhengYuhuiã€‘ (OV25120323) - é‡‘ç´š - åŠ å…¥: 2025-12-26
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ã€SoonHuaSanã€‘ (OV25120309) - ç™½é‡‘ - åŠ å…¥: 2025-12-26
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ ã€SoonHuaSanã€‘ (OV25120310) - ç™½é‡‘ - åŠ å…¥: 2025-12-26
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚   â”‚       â””â”€â”€ ã€SoonHuaSanã€‘ (OV25120311) - ç™½é‡‘ - åŠ å…¥: 2025-12-26
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚   â””â”€â”€ ã€ChanSokeHoã€‘ (OV25120298) - é‘½çŸ³ - åŠ å…¥: 2025-12-26
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚       â”œâ”€â”€ ã€ChanSiewNgã€‘ (OV25120216) - é‘½çŸ³ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ ã€ChanPohTiaã€‘ (OV25120220) - é‡‘ç´š - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚       â”‚   â”‚   â””â”€â”€ ã€TanSiewHonã€‘ (OV25120219) - é‘½çŸ³ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚       â”‚   â”‚       â”œâ”€â”€ ã€TanHongChoã€‘ (OV25120324) - ç™½é‡‘ - åŠ å…¥: 2025-12-26
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚       â”‚   â”‚       â””â”€â”€ ã€TanSiewHonã€‘ (OV25120325) - éŠ€ç´š - åŠ å…¥: 2025-12-26
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚       â”‚   â””â”€â”€ ã€ChaiJiaLinã€‘ (OV25120392) - éŠ€ç´š - åŠ å…¥: 2025-12-30
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚       â”‚       â”œâ”€â”€ ã€LamLaiLingã€‘ (OV26010013) - é‡‘ç´š - åŠ å…¥: 2026-01-12
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚       â”‚       â”‚   â””â”€â”€ ã€LamChuiPikã€‘ (OV26010014) - é‡‘ç´š - åŠ å…¥: 2026-01-12
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚       â”‚       â””â”€â”€ ã€NgianBeeKhã€‘ (OV25120393) - éŠ…ç´š - åŠ å…¥: 2025-12-30
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚       â””â”€â”€ ã€ChanSokKooã€‘ (OV25120215) - é‘½çŸ³ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚           â”œâ”€â”€ ã€KhwanruanWã€‘ (OV25120217) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚           â”‚   â””â”€â”€ ã€LeongSookFã€‘ (OV25120287) - ç™½é‡‘ - åŠ å…¥: 2025-12-25
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚           â”‚       â”œâ”€â”€ ã€LeongSookFã€‘ (OV25120288) - é‡‘ç´š - åŠ å…¥: 2025-12-25
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚           â”‚       â””â”€â”€ ã€KohKahBoonã€‘ (OV25120292) - é‡‘ç´š - åŠ å…¥: 2025-12-25
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚           â””â”€â”€ ã€ChanSokKooã€‘ (OV25120284) - ç™½é‡‘ - åŠ å…¥: 2025-12-24
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚               â””â”€â”€ ã€GohBeeKianã€‘ (OV25120218) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚                   â”œâ”€â”€ ã€GohBeeKianã€‘ (OV25120285) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚       â”‚   â”‚   â”‚                   â””â”€â”€ ã€GohBeeKianã€‘ (OV25120286) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚       â”‚   â”‚   â””â”€â”€ ã€SimElynã€‘ (OV25120097) - é‘½çŸ³ - åŠ å…¥: 2025-12-13
â”‚   â”‚       â”‚       â”‚   â”‚       â”œâ”€â”€ ã€SimYiShiYaã€‘ (OV25120098) - é‘½çŸ³ - åŠ å…¥: 2025-12-13
â”‚   â”‚       â”‚       â”‚   â”‚       â”‚   â””â”€â”€ ã€LeeLehKhenã€‘ (OV25120376) - é‘½çŸ³ - åŠ å…¥: 2025-12-30
â”‚   â”‚       â”‚       â”‚   â”‚       â”‚       â”œâ”€â”€ ã€ChanFongPeã€‘ (OV25120377) - ç™½é‡‘ - åŠ å…¥: 2025-12-30
â”‚   â”‚       â”‚       â”‚   â”‚       â”‚       â”‚   â”œâ”€â”€ ã€NgSweeChooã€‘ (OV25120379) - ç™½é‡‘ - åŠ å…¥: 2025-12-30
â”‚   â”‚       â”‚       â”‚   â”‚       â”‚       â”‚   â”‚   â”œâ”€â”€ ã€NgSweeChooã€‘ (OV25120380) - ç™½é‡‘ - åŠ å…¥: 2025-12-30
â”‚   â”‚       â”‚       â”‚   â”‚       â”‚       â”‚   â”‚   â””â”€â”€ ã€NgSweeChooã€‘ (OV25120381) - ç™½é‡‘ - åŠ å…¥: 2025-12-30
â”‚   â”‚       â”‚       â”‚   â”‚       â”‚       â”‚   â””â”€â”€ ã€BaiHuaã€‘ (OV25120382) - éŠ€ç´š - åŠ å…¥: 2025-12-30
â”‚   â”‚       â”‚       â”‚   â”‚       â”‚       â”‚       â””â”€â”€ ã€LauBeeHuaã€‘ (SG26010044) - é‡‘ç´š - åŠ å…¥: 2026-01-14
â”‚   â”‚       â”‚       â”‚   â”‚       â”‚       â””â”€â”€ ã€ThamSiewKiã€‘ (OV25120378) - ç™½é‡‘ - åŠ å…¥: 2025-12-30
â”‚   â”‚       â”‚       â”‚   â”‚       â””â”€â”€ ã€SimWeeLiã€‘ (OV25120364) - éŠ€ç´š - åŠ å…¥: 2025-12-29
â”‚   â”‚       â”‚       â”‚   â”‚           â”œâ”€â”€ ã€AaronShenã€‘ (OV25120365) - éŠ…ç´š - åŠ å…¥: 2025-12-29
â”‚   â”‚       â”‚       â”‚   â”‚           â”‚   â””â”€â”€ ã€TeoSooBoonã€‘ (SG26010025) - ç™½é‡‘ - åŠ å…¥: 2026-01-14
â”‚   â”‚       â”‚       â”‚   â”‚           â”‚       â””â”€â”€ ã€TeoSoonHooã€‘ (SG26010026) - é‡‘ç´š - åŠ å…¥: 2026-01-14
â”‚   â”‚       â”‚       â”‚   â”‚           â”‚           â””â”€â”€ ã€YeoBeePingã€‘ (SG26010027) - éŠ€ç´š - åŠ å…¥: 2026-01-14
â”‚   â”‚       â”‚       â”‚   â”‚           â””â”€â”€ ã€ChangSiowQã€‘ (OV25120366) - éŠ…ç´š - åŠ å…¥: 2025-12-29
â”‚   â”‚       â”‚       â”‚   â””â”€â”€ ã€SimplyShalã€‘ (OV25120096) - ç™½é‡‘ - åŠ å…¥: 2025-12-13
â”‚   â”‚       â”‚       â”‚       â”œâ”€â”€ ã€LimKweeEngã€‘ (OV25120334) - ç™½é‡‘ - åŠ å…¥: 2025-12-26
â”‚   â”‚       â”‚       â”‚       â”‚   â””â”€â”€ ã€FooSockPhoã€‘ (OV25120335) - ç™½é‡‘ - åŠ å…¥: 2025-12-26
â”‚   â”‚       â”‚       â”‚       â””â”€â”€ ã€TongXiaoYaã€‘ (OV25120363) - é‡‘ç´š - åŠ å…¥: 2025-12-29
â”‚   â”‚       â”‚       â””â”€â”€ ã€SimplyShalã€‘ (OV25120184) - ç™½é‡‘ - åŠ å…¥: 2025-12-19
â”‚   â”‚       â”‚           â”œâ”€â”€ ã€SimplyShalã€‘ (OV25120185) - ç™½é‡‘ - åŠ å…¥: 2025-12-19
â”‚   â”‚       â”‚           â”‚   â”œâ”€â”€ ã€TanSiewKhiã€‘ (OV25120384) - éŠ€ç´š - åŠ å…¥: 2025-12-30
â”‚   â”‚       â”‚           â”‚   â””â”€â”€ ã€LimNyukLiaã€‘ (OV25120383) - éŠ€ç´š - åŠ å…¥: 2025-12-30
â”‚   â”‚       â”‚           â””â”€â”€ ã€SimplyShalã€‘ (OV25120186) - ç™½é‡‘ - åŠ å…¥: 2025-12-19
â”‚   â”‚       â”‚               â”œâ”€â”€ ã€SeoEngFoonã€‘ (OV25120239) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚               â”‚   â”œâ”€â”€ ã€SeoEngFoonã€‘ (OV25120267) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚               â”‚   â”‚   â””â”€â”€ ã€TiTuanLucyã€‘ (OV25120274) - é‘½çŸ³ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚               â”‚   â”‚       â”œâ”€â”€ ã€TiTuanLucyã€‘ (OV25120278) - é‘½çŸ³ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚               â”‚   â”‚       â”‚   â”œâ”€â”€ ã€ChanYongChã€‘ (OV25120280) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚               â”‚   â”‚       â”‚   â”‚   â”œâ”€â”€ ã€NgChoonLanã€‘ (OV25120371) - ç™½é‡‘ - åŠ å…¥: 2025-12-31
â”‚   â”‚       â”‚               â”‚   â”‚       â”‚   â”‚   â””â”€â”€ ã€LimYeowBuaã€‘ (SG26010001) - é‘½çŸ³ - åŠ å…¥: 2026-01-08
â”‚   â”‚       â”‚               â”‚   â”‚       â”‚   â””â”€â”€ ã€TiTuanLucyã€‘ (OV25120279) - é‡‘ç´š - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚               â”‚   â”‚       â”‚       â””â”€â”€ ã€WongSizNguã€‘ (SG26010034) - é‡‘ç´š - åŠ å…¥: 2026-01-14
â”‚   â”‚       â”‚               â”‚   â”‚       â””â”€â”€ ã€TiTuanLucyã€‘ (OV25120275) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚               â”‚   â”‚           â”œâ”€â”€ ã€TiTuanLucyã€‘ (OV25120276) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚               â”‚   â”‚           â””â”€â”€ ã€TiTuanLucyã€‘ (OV25120277) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚               â”‚   â””â”€â”€ ã€SeoEngFoonã€‘ (OV25120268) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚               â””â”€â”€ ã€ç‹ç«‹å¾·ã€‘ (OV25120060) - ç™½é‡‘ - åŠ å…¥: 2025-12-13
â”‚   â”‚       â”‚                   â”œâ”€â”€ ã€ç‹ç«‹å¾·ã€‘ (OV25120061) - éŠ€ç´š - åŠ å…¥: 2025-12-13
â”‚   â”‚       â”‚                   â”‚   â”œâ”€â”€ ã€SarahGohYiã€‘ (SG26010005) - é‘½çŸ³ - åŠ å…¥: 2026-01-13
â”‚   â”‚       â”‚                   â”‚   â”‚   â”œâ”€â”€ ã€SarahGohYiã€‘ (SG26010007) - é‡‘ç´š - åŠ å…¥: 2026-01-13
â”‚   â”‚       â”‚                   â”‚   â”‚   â”‚   â””â”€â”€ ã€ChingLayPeã€‘ (SG26010008) - ç™½é‡‘ - åŠ å…¥: 2026-01-13
â”‚   â”‚       â”‚                   â”‚   â”‚   â”‚       â”œâ”€â”€ ã€ChingLayPeã€‘ (SG26010012) - é‡‘ç´š - åŠ å…¥: 2026-01-17
â”‚   â”‚       â”‚                   â”‚   â”‚   â”‚       â””â”€â”€ ã€ChingLayPeã€‘ (SG26010009) - é‡‘ç´š - åŠ å…¥: 2026-01-13
â”‚   â”‚       â”‚                   â”‚   â”‚   â””â”€â”€ ã€SarahGohYiã€‘ (SG26010006) - ç™½é‡‘ - åŠ å…¥: 2026-01-13
â”‚   â”‚       â”‚                   â”‚   â”‚       â”œâ”€â”€ ã€WongSiewPeã€‘ (SG26010010) - é‡‘ç´š - åŠ å…¥: 2026-01-13
â”‚   â”‚       â”‚                   â”‚   â”‚       â”‚   â””â”€â”€ ã€ShangPeiLiã€‘ (SG26010011) - é‡‘ç´š - åŠ å…¥: 2026-01-13
â”‚   â”‚       â”‚                   â”‚   â”‚       â””â”€â”€ ã€CHENSUETMUã€‘ (OV26010018) - é‘½çŸ³ - åŠ å…¥: 2026-01-12
â”‚   â”‚       â”‚                   â”‚   â”‚           â”œâ”€â”€ ã€CHENSUETMUã€‘ (OV26010020) - é‡‘ç´š - åŠ å…¥: 2026-01-12
â”‚   â”‚       â”‚                   â”‚   â”‚           â””â”€â”€ ã€CHENSUETMUã€‘ (OV26010019) - ç™½é‡‘ - åŠ å…¥: 2026-01-12
â”‚   â”‚       â”‚                   â”‚   â””â”€â”€ ã€FungMeiLinã€‘ (OV25120207) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚                   â”‚       â”œâ”€â”€ ã€FungMeiMeiã€‘ (OV25120209) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚                   â”‚       â”‚   â”œâ”€â”€ ã€ChongSeeLeã€‘ (OV25120210) - é‘½çŸ³ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚                   â”‚       â”‚   â”‚   â”œâ”€â”€ ã€ChongChanVã€‘ (OV25120212) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚                   â”‚       â”‚   â”‚   â””â”€â”€ ã€LowKwaiChaã€‘ (OV25120211) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚                   â”‚       â”‚   â””â”€â”€ ã€LeeYinLianã€‘ (OV25120257) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚                   â”‚       â”‚       â”œâ”€â”€ ã€LeeYinLianã€‘ (OV25120258) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚                   â”‚       â”‚       â””â”€â”€ ã€LeeYinLianã€‘ (OV25120259) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚                   â”‚       â””â”€â”€ ã€FungMeiLinã€‘ (OV25120208) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
â”‚   â”‚       â”‚                   â””â”€â”€ ã€è¶™æ…§å¨Ÿã€‘ (OV25120062) - é‡‘ç´š - åŠ å…¥: 2025-12-13
â”‚   â”‚       â”‚                       â”œâ”€â”€ ã€WingYingCoã€‘ (OV25120063) - é‘½çŸ³ - åŠ å…¥: 2025-12-13
â”‚   â”‚       â”‚                       â”‚   â”œâ”€â”€ ã€WingYingCoã€‘ (OV25120064) - é‘½çŸ³ - åŠ å…¥: 2025-12-13
â”‚   â”‚       â”‚                       â”‚   â”‚   â”œâ”€â”€ ã€TangCheungã€‘ (OV25120076) - é‘½çŸ³ - åŠ å…¥: 2025-12-13
â”‚   â”‚       â”‚                       â”‚   â”‚   â”‚   â”œâ”€â”€ ã€TangCheungã€‘ (OV25120079) - ç™½é‡‘ - åŠ å…¥: 2025-12-13
â”‚   â”‚       â”‚                       â”‚   â”‚   â”‚   â””â”€â”€ ã€TangCheungã€‘ (OV25120398) - ç™½é‡‘ - åŠ å…¥: 2025-12-29
â”‚   â”‚       â”‚                       â”‚   â”‚   â””â”€â”€ ã€LalaCharmCã€‘ (OV25120077) - ç™½é‡‘ - åŠ å…¥: 2025-12-13
â”‚   â”‚       â”‚                       â”‚   â”‚       â”œâ”€â”€ ã€WongChingã€‘ (OV26010001) - éŠ€ç´š - åŠ å…¥: 2026-01-12
â”‚   â”‚       â”‚                       â”‚   â”‚       â””â”€â”€ ã€LAMSIUSHANã€‘ (OV25120397) - éŠ€ç´š - åŠ å…¥: 2025-12-29
â”‚   â”‚       â”‚                       â”‚   â””â”€â”€ ã€WingYingCoã€‘ (OV25120065) - é‘½çŸ³ - åŠ å…¥: 2025-12-13
â”‚   â”‚       â”‚                       â”‚       â”œâ”€â”€ ã€å§œé‡‘å›ã€‘ (OV25120226) - ç™½é‡‘ - åŠ å…¥: 2025-12-20
â”‚   â”‚       â”‚                       â”‚       â”‚   â”œâ”€â”€ ã€å§œé‡‘å›ã€‘ (OV25120227) - ç™½é‡‘ - åŠ å…¥: 2025-12-20
â”‚   â”‚       â”‚                       â”‚       â”‚   â””â”€â”€ ã€å§œé‡‘å›ã€‘ (OV25120228) - ç™½é‡‘ - åŠ å…¥: 2025-12-20
â”‚   â”‚       â”‚                       â”‚       â””â”€â”€ ã€SZETOPUIHOã€‘ (OV25120140) - ç™½é‡‘ - åŠ å…¥: 2025-12-13
â”‚   â”‚       â”‚                       â”‚           â”œâ”€â”€ ã€SZETOPUIHOã€‘ (OV25120141) - ç™½é‡‘ - åŠ å…¥: 2025-12-13
â”‚   â”‚       â”‚                       â”‚           â””â”€â”€ ã€SZETOPUIHOã€‘ (OV25120142) - ç™½é‡‘ - åŠ å…¥: 2025-12-13
â”‚   â”‚       â”‚                       â””â”€â”€ ã€é„­ä¾å®¸ã€‘ (TW26010008) - é‡‘ç´š - åŠ å…¥: 2026-01-08
â”‚   â”‚       â”‚                           â”œâ”€â”€ ã€å¼µç¾åª›ã€‘ (TW26010010) - éŠ€ç´š - åŠ å…¥: 2026-01-08
â”‚   â”‚       â”‚                           â””â”€â”€ ã€å®‹åšæ·µã€‘ (TW26010009) - é‡‘ç´š - åŠ å…¥: 2026-01-08
â”‚   â”‚       â””â”€â”€ ã€æ›¹æ™‚èªã€‘ (OV25120050) - ç™½é‡‘ - åŠ å…¥: 2025-12-13
â”‚   â””â”€â”€ ã€ç‹æœ¨æ¦®ã€‘ (OV25120042) - ç™½é‡‘ - åŠ å…¥: 2025-12-13
â””â”€â”€ ã€ç‹æœ¨æ¦®ã€‘ (OV25120043) - ç™½é‡‘ - åŠ å…¥: 2025-12-13
    â”œâ”€â”€ ã€ç‹æœ¨æ¦®ã€‘ (OV25120044) - ç™½é‡‘ - åŠ å…¥: 2025-12-13
    â”‚   â””â”€â”€ ã€è‘‰è‰·ç§‹ã€‘ (OV25120051) - é‘½çŸ³ - åŠ å…¥: 2025-12-13
    â”‚       â”œâ”€â”€ ã€ç‹è†æœ±ã€‘ (OV25120053) - éŠ€ç´š - åŠ å…¥: 2025-12-13
    â”‚       â”‚   â”œâ”€â”€ ã€æ¥Šç‰ç’°ã€‘ (OV25120327) - ç™½é‡‘ - åŠ å…¥: 2025-12-26
    â”‚       â”‚   â”‚   â”œâ”€â”€ ã€æ¥Šç‰ç’°ã€‘ (OV25120328) - ç™½é‡‘ - åŠ å…¥: 2025-12-26
    â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ ã€æ¥Šç‰çã€‘ (OV25120331) - éŠ€ç´š - åŠ å…¥: 2025-12-26
    â”‚       â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ã€åŠ‰æ€å¦¤ã€‘ (OV25120332) - éŠ…ç´š - åŠ å…¥: 2025-12-26
    â”‚       â”‚   â”‚   â”‚   â””â”€â”€ ã€å¼µåº­æ…ˆã€‘ (OV25120362) - é‡‘ç´š - åŠ å…¥: 2025-12-29
    â”‚       â”‚   â”‚   â””â”€â”€ ã€æ¥Šç‰ç’°ã€‘ (OV25120329) - ç™½é‡‘ - åŠ å…¥: 2025-12-26
    â”‚       â”‚   â”‚       â””â”€â”€ ã€é„­æ»¿ã€‘ (OV25120330) - éŠ€ç´š - åŠ å…¥: 2025-12-26
    â”‚       â”‚   â”‚           â””â”€â”€ ã€å³é‡‘ç‡•ã€‘ (OV25120333) - é‡‘ç´š - åŠ å…¥: 2025-12-26
    â”‚       â”‚   â””â”€â”€ ã€è‘‰è³€å‰ã€‘ (OV25120213) - éŠ€ç´š - åŠ å…¥: 2025-12-21
    â”‚       â”‚       â”œâ”€â”€ ã€è•­é‡‘è“‰ã€‘ (OV25120247) - é‡‘ç´š - åŠ å…¥: 2025-12-21
    â”‚       â”‚       â””â”€â”€ ã€ç°¡éŸ»ç³ã€‘ (OV25120360) - é‡‘ç´š - åŠ å…¥: 2025-12-29
    â”‚       â”‚           â””â”€â”€ ã€é„­åº­èŠ³ã€‘ (OV25120361) - éŠ€ç´š - åŠ å…¥: 2025-12-29
    â”‚       â””â”€â”€ ã€è‘‰è‰·ç§‹ã€‘ (OV25120054) - é‡‘ç´š - åŠ å…¥: 2025-12-13
    â”‚           â”œâ”€â”€ ã€é™³ç¾ç¶ºã€‘ (TW26010119) - VIP - åŠ å…¥: 2026-01-15
    â”‚           â”‚   â”œâ”€â”€ ã€é™³ç¾ç¶ºã€‘ (TW26010120) - VIP - åŠ å…¥: 2026-01-15
    â”‚           â”‚   â”‚   â”œâ”€â”€ ã€å³è‚²è˜­ã€‘ (OV25120240) - é‘½çŸ³ - åŠ å…¥: 2025-12-20
    â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ ã€å³è‚²è˜­ã€‘ (OV25120241) - ç™½é‡‘ - åŠ å…¥: 2025-12-20
    â”‚           â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ã€é™³é›ã€‘ (OV25120243) - é‡‘ç´š - åŠ å…¥: 2025-12-20
    â”‚           â”‚   â”‚   â”‚   â”‚       â””â”€â”€ ã€å¼µè²¡é€šã€‘ (OV25120244) - ç™½é‡‘ - åŠ å…¥: 2025-12-20
    â”‚           â”‚   â”‚   â”‚   â”‚           â”œâ”€â”€ ã€å¼µè²¡é€šã€‘ (OV25120245) - ç™½é‡‘ - åŠ å…¥: 2025-12-20
    â”‚           â”‚   â”‚   â”‚   â”‚           â””â”€â”€ ã€å¼µè²¡é€šã€‘ (OV25120246) - ç™½é‡‘ - åŠ å…¥: 2025-12-20
    â”‚           â”‚   â”‚   â”‚   â””â”€â”€ ã€å³è‚²è˜­ã€‘ (OV25120242) - é‡‘ç´š - åŠ å…¥: 2025-12-20
    â”‚           â”‚   â”‚   â”‚       â””â”€â”€ ã€é™³ç¾è“ã€‘ (TW26010062) - é‡‘ç´š - åŠ å…¥: 2026-01-14
    â”‚           â”‚   â”‚   â”‚           â”œâ”€â”€ ã€é™³ç¾è“ã€‘ (TW26010106) - VIP - åŠ å…¥: 2026-01-15
    â”‚           â”‚   â”‚   â”‚           â””â”€â”€ ã€è‘‰çµ²ç¶¸ã€‘ (TW26010085) - VIP - åŠ å…¥: 2026-01-15
    â”‚           â”‚   â”‚   â””â”€â”€ ã€çŸ³ç§‹æœˆã€‘ (TW26010126) - VIP - åŠ å…¥: 2026-01-15
    â”‚           â”‚   â””â”€â”€ ã€æ—çˆç¾½ã€‘ (TW26010121) - VIP - åŠ å…¥: 2026-01-15
    â”‚           â””â”€â”€ ã€é»ƒæ€¡æ½”ã€‘ (OV25120248) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
    â”‚               â”œâ”€â”€ ã€é»ƒæ€¡æ½”ã€‘ (OV25120249) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
    â”‚               â””â”€â”€ ã€é»ƒæ€¡æ½”ã€‘ (OV25120250) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
    â”‚                   â”œâ”€â”€ ã€é™³å˜‰å®¹ã€‘ (OV25120251) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
    â”‚                   â”‚   â”œâ”€â”€ ã€é™³å˜‰å®¹ã€‘ (OV25120252) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
    â”‚                   â”‚   â””â”€â”€ ã€é™³å˜‰å®¹ã€‘ (OV25120253) - ç™½é‡‘ - åŠ å…¥: 2025-12-21
    â”‚                   â””â”€â”€ ã€å³å²±åº­ã€‘ (OV25120352) - é‡‘ç´š - åŠ å…¥: 2025-12-29
    â”‚                       â”œâ”€â”€ ã€é„­æ˜¥æ¢…ã€‘ (TW26010167) - VIP - åŠ å…¥: 2026-01-14
    â”‚                       â””â”€â”€ ã€å³æ—»è”šã€‘ (TW26010166) - éŠ€ç´š - åŠ å…¥: 2026-01-14
    â””â”€â”€ ã€ç‹æœ¨æ¦®ã€‘ (OV25120045) - ç™½é‡‘ - åŠ å…¥: 2025-12-13
        â”œâ”€â”€ ã€é»„éº—èŠ±ã€‘ (OV26010002) - ç™½é‡‘ - åŠ å…¥: 2026-01-12
        â””â”€â”€ ã€ç‹æµ©å®‡ã€‘ (TW26010168) - VIP - åŠ å…¥: 2026-01-14
    `;

    // è‘‰è‰·ç§‹çš„è³‡æ–™ (ä½¿ç”¨æ–°æ ¼å¼ No Brackets)
    const rawDataYeh = `
è‘‰è‰·ç§‹ (OV25120051) - é‘½çŸ³ - åŠ å…¥æ—¥æœŸ: 2025-12-13
    â”œâ”€â”€ ç‹è†æœ± (OV25120053) - éŠ€ç´š - åŠ å…¥æ—¥æœŸ: 2025-12-13
    â”‚   â”œâ”€â”€ æ¥Šç‰ç’° (OV25120327) - ç™½é‡‘ - åŠ å…¥æ—¥æœŸ: 2025-12-26
    â”‚   â”‚   â”œâ”€â”€ æ¥Šç‰ç’° (OV25120328) - ç™½é‡‘ - åŠ å…¥æ—¥æœŸ: 2025-12-26
    â”‚   â”‚   â”‚   â”œâ”€â”€ æ¥Šç‰ç (OV25120331) - éŠ€ç´š - åŠ å…¥æ—¥æœŸ: 2025-12-26
    â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ åŠ‰æ€å¦¤ (OV25120332) - éŠ…ç´š - åŠ å…¥æ—¥æœŸ: 2025-12-26
    â”‚   â”‚   â”‚   â”‚   â””â”€â”€ (ç©ºç¼º)
    â”‚   â”‚   â”‚   â””â”€â”€ å¼µåº­æ…ˆ (OV25120362) - é‡‘ç´š - åŠ å…¥æ—¥æœŸ: 2025-12-29
    â”‚   â”‚   â””â”€â”€ æ¥Šç‰ç’° (OV25120329) - ç™½é‡‘ - åŠ å…¥æ—¥æœŸ: 2025-12-26
    â”‚   â”‚       â”œâ”€â”€ (ç©ºç¼º)
    â”‚   â”‚       â””â”€â”€ é„­æ»¿ (OV25120330) - éŠ€ç´š - åŠ å…¥æ—¥æœŸ: 2025-12-26
    â”‚   â”‚           â”œâ”€â”€ (ç©ºç¼º)
    â”‚   â”‚           â””â”€â”€ å³é‡‘ç‡• (OV25120333) - é‡‘ç´š - åŠ å…¥æ—¥æœŸ: 2025-12-26
    â”‚   â””â”€â”€ è‘‰è³€å‰ (OV25120213) - éŠ€ç´š - åŠ å…¥æ—¥æœŸ: 2025-12-21
    â”‚       â”œâ”€â”€ è•­é‡‘è“‰ (OV25120247) - é‡‘ç´š - åŠ å…¥æ—¥æœŸ: 2025-12-21
    â”‚       â””â”€â”€ ç°¡éŸ»ç³ (OV25120360) - é‡‘ç´š - åŠ å…¥æ—¥æœŸ: 2025-12-29
    â”‚           â”œâ”€â”€ (ç©ºç¼º)
    â”‚           â””â”€â”€ é„­åº­èŠ³ (OV25120361) - éŠ€ç´š - åŠ å…¥æ—¥æœŸ: 2025-12-29
    â””â”€â”€ è‘‰è‰·ç§‹ (OV25120054) - é‡‘ç´š - åŠ å…¥æ—¥æœŸ: 2025-12-13
        â”œâ”€â”€ é™³ç¾ç¶º (TW26010119) - VIP - åŠ å…¥æ—¥æœŸ: 2026-01-15
        â”‚   â”œâ”€â”€ é™³ç¾ç¶º (TW26010120) - VIP - åŠ å…¥æ—¥æœŸ: 2026-01-15
        â”‚   â”‚   â”œâ”€â”€ å³è‚²è˜­ (OV25120240) - é‘½çŸ³ - åŠ å…¥æ—¥æœŸ: 2025-12-20
        â”‚   â”‚   â”‚   â”œâ”€â”€ å³è‚²è˜­ (OV25120241) - ç™½é‡‘ - åŠ å…¥æ—¥æœŸ: 2025-12-20
        â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ é™³é› (OV25120243) - é‡‘ç´š - åŠ å…¥æ—¥æœŸ: 2025-12-20
        â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ å¼µè²¡é€š (OV25120244) - ç™½é‡‘ - åŠ å…¥æ—¥æœŸ: 2025-12-20
        â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ å¼µè²¡é€š (OV25120245) - ç™½é‡‘ - åŠ å…¥æ—¥æœŸ: 2025-12-20
        â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ å¼µè²¡é€š (OV25120246) - ç™½é‡‘ - åŠ å…¥æ—¥æœŸ: 2025-12-20
        â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ (ç©ºç¼º)
        â”‚   â”‚   â”‚   â”‚   â””â”€â”€ (ç©ºç¼º)
        â”‚   â”‚   â”‚   â””â”€â”€ å³è‚²è˜­ (OV25120242) - é‡‘ç´š - åŠ å…¥æ—¥æœŸ: 2025-12-20
        â”‚   â”‚   â”‚       â”œâ”€â”€ (ç©ºç¼º)
        â”‚   â”‚   â”‚       â””â”€â”€ é™³ç¾è“ (TW26010062) - é‡‘ç´š - åŠ å…¥æ—¥æœŸ: 2026-01-14
        â”‚   â”‚   â”‚           â”œâ”€â”€ é™³ç¾è“ (TW26010106) - VIP - åŠ å…¥æ—¥æœŸ: 2026-01-15
        â”‚   â”‚   â”‚           â””â”€â”€ è‘‰çµ²ç¶¸ (TW26010085) - VIP - åŠ å…¥æ—¥æœŸ: 2026-01-15
        â”‚   â”‚   â””â”€â”€ çŸ³ç§‹æœˆ (TW26010126) - VIP - åŠ å…¥æ—¥æœŸ: 2026-01-15
        â”‚   â””â”€â”€ æ—çˆç¾½ (TW26010121) - VIP - åŠ å…¥æ—¥æœŸ: 2026-01-15
        â””â”€â”€ é»ƒæ€¡æ½” (OV25120248) - ç™½é‡‘ - åŠ å…¥æ—¥æœŸ: 2025-12-21
            â”œâ”€â”€ é»ƒæ€¡æ½” (OV25120249) - ç™½é‡‘ - åŠ å…¥æ—¥æœŸ: 2025-12-21
            â””â”€â”€ é»ƒæ€¡æ½” (OV25120250) - ç™½é‡‘ - åŠ å…¥æ—¥æœŸ: 2025-12-21
                â”œâ”€â”€ é™³å˜‰å®¹ (OV25120251) - ç™½é‡‘ - åŠ å…¥æ—¥æœŸ: 2025-12-21
                â”‚   â”œâ”€â”€ é™³å˜‰å®¹ (OV25120252) - ç™½é‡‘ - åŠ å…¥æ—¥æœŸ: 2025-12-21
                â”‚   â””â”€â”€ é™³å˜‰å®¹ (OV25120253) - ç™½é‡‘ - åŠ å…¥æ—¥æœŸ: 2025-12-21
                â””â”€â”€ å³å²±åº­ (OV25120352) - é‡‘ç´š - åŠ å…¥æ—¥æœŸ: 2025-12-29
                    â”œâ”€â”€ é„­æ˜¥æ¢… (TW26010167) - VIP - åŠ å…¥æ—¥æœŸ: 2026-01-14
                    â””â”€â”€ å³æ—»è”š (TW26010166) - éŠ€ç´š - åŠ å…¥æ—¥æœŸ: 2026-01-14
    `;

    // --- 2. é‚è¼¯å€ (Logic) ---

    // æ™ºèƒ½è§£æå™¨ (è‡ªå‹•åˆ¤æ–·æ ¼å¼)
    function parseData(text) {
        const lines = text.split('\n').filter(line => line.trim() !== '');
        let root = { children: [] };
        let stack = [root];

        lines.forEach(line => {
            // è¨ˆç®—ç¸®æ’
            const contentIndex = line.search(/[^ \tâ”‚â”œâ””â”€]/);
            if (contentIndex === -1) return;
            const level = Math.floor(contentIndex / 4);

            const content = line.substring(contentIndex);
            
            // åˆ¤æ–·æ˜¯å“ªç¨®æ ¼å¼ (æœ‰æ²’æœ‰ã€ã€‘)
            let match;
            let nodeData = { name: content, id: "", rank: "", date: "", children: [] };

            if (content.includes('ã€')) {
                // ç‹æœ¨æ¦®æ ¼å¼
                match = content.match(/ã€(.*?)ã€‘\s*\((.*?)\)\s*-\s*(.*?)\s*-\s*åŠ å…¥:\s*(.*)/);
            } else {
                // è‘‰è‰·ç§‹æ ¼å¼
                match = content.match(/(.*?)\s*\((.*?)\)\s*-\s*(.*?)\s*-\s*åŠ å…¥æ—¥æœŸ:\s*(.*)/);
            }

            if (match) {
                nodeData.name = match[1].trim();
                nodeData.id = match[2].trim();
                nodeData.rank = match[3].trim();
                nodeData.date = match[4].trim();
            } else if (content.includes("ç©ºç¼º")) {
                nodeData.name = "ç©ºç¼º";
                nodeData.rank = "emp";
            }

            while (stack.length > level + 1) stack.pop();
            stack[stack.length - 1].children.push(nodeData);
            stack.push(nodeData);
        });
        return root;
    }

    // æ¸²æŸ“ HTML
    function renderTree(node, isRoot = false) {
        if (!node.children || node.children.length === 0) return '';
        let html = '<ul>';
        node.children.forEach(child => {
            // é¡è‰²åˆ¤æ–·
            let colorClass = '';
            const r = child.rank;
            if (r.includes('é‘½çŸ³')) colorClass = 'dia';
            else if (r.includes('ç™½é‡‘')) colorClass = 'pla';
            else if (r.includes('é‡‘ç´š')) colorClass = 'gold';
            else if (r.includes('éŠ€ç´š')) colorClass = 'sil';
            else if (r.includes('VIP')) colorClass = 'vip';
            else if (r === 'emp') colorClass = 'emp';

            // ç‹€æ…‹
            const hasChildren = child.children && child.children.length > 0;
            const toggleIcon = hasChildren ? (isRoot ? 'âˆ’' : '+') : '';
            const emptyClass = hasChildren ? '' : 'empty';
            const childCount = hasChildren ? `<span class="count">${child.children.length}</span>` : '';
            // é è¨­å±•é–‹ç‹€æ…‹ï¼šç‹æœ¨æ¦®çš„ç¬¬ä¸€å±¤é è¨­å±•é–‹ï¼Œå…¶ä»–æŠ˜ç–Š
            const initialState = isRoot ? '' : 'hidden'; 

            html += `
                <li>
                    <div class="node-content" onclick="toggleNode(this)">
                        <span class="toggle-btn ${emptyClass}">${toggleIcon}</span>
                        <span class="rank-tag ${colorClass}">${child.rank === 'emp' ? 'ç©ºç¼º' : child.rank}</span>
                        <span class="name">${child.name}</span>
                        <span class="id">${child.id}</span>
                        <span class="date">${child.date}</span>
                        ${childCount}
                    </div>
                    ${hasChildren ? `<div class="${initialState}">` + renderTree(child, false) + `</div>` : ''}
                </li>
            `;
        });
        html += '</ul>';
        return html;
    }

    // --- 3. äº’å‹•åŠŸèƒ½ (Interact) ---

    // åˆ‡æ›åˆ†é 
    function switchTab(tabId, btnElement) {
        // éš±è—æ‰€æœ‰å…§å®¹
        document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
        
        // é¡¯ç¤ºé¸å®šå…§å®¹
        document.getElementById(tabId).classList.add('active');
        btnElement.classList.add('active');
    }

    // æŠ˜ç–Šç¯€é»
    function toggleNode(element) {
        const nextDiv = element.nextElementSibling;
        const iconSpan = element.querySelector('.toggle-btn');
        if (nextDiv) {
            nextDiv.classList.toggle('hidden');
            iconSpan.textContent = nextDiv.classList.contains('hidden') ? '+' : 'âˆ’';
        }
    }

    // å…¨éƒ¨å±•é–‹ (åªé‡å°ç•¶å‰å¯è¦‹çš„ Tab)
    function expandAll() {
        const activeTab = document.querySelector('.tab-content.active');
        activeTab.querySelectorAll('.hidden').forEach(el => el.classList.remove('hidden'));
        activeTab.querySelectorAll('.toggle-btn:not(.empty)').forEach(btn => btn.textContent = 'âˆ’');
    }

    // å…¨éƒ¨æŠ˜ç–Š (åªé‡å°ç•¶å‰å¯è¦‹çš„ Tab)
    function collapseAll() {
        const activeTab = document.querySelector('.tab-content.active');
        // é¸æ“‡è©²åˆ†é ä¸‹æ‰€æœ‰å¯æŠ˜ç–Šå€å¡Š (æ’é™¤ç¬¬ä¸€å±¤)
        activeTab.querySelectorAll('.tree > ul > li > div div').forEach(el => el.classList.add('hidden'));
        activeTab.querySelectorAll('.toggle-btn:not(.empty)').forEach(btn => btn.textContent = '+');
    }

    // --- 4. åˆå§‹åŒ– ---
    const treeWang = parseData(rawDataWang);
    const treeYeh = parseData(rawDataYeh);

    // æ¸²æŸ“å…©å€‹æ¨¹ç‹€åœ– (true ä»£è¡¨æ˜¯æ ¹ç›®éŒ„ï¼Œé è¨­å±•é–‹ç¬¬ä¸€å±¤)
    document.getElementById('tree-wang').innerHTML = renderTree(treeWang, true);
    document.getElementById('tree-yeh').innerHTML = renderTree(treeYeh, true);

</script>

</body>
</html>